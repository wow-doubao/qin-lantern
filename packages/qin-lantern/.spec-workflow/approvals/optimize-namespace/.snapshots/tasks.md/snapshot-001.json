{
  "id": "snapshot_1768059391213_wo8k2dj1x",
  "approvalId": "approval_1768059391205_iqjsnzvht",
  "approvalTitle": "任务文档：命名空间优化与样式分离 (Tasks: Optimize Namespace & Style Separation)",
  "version": 1,
  "timestamp": "2026-01-10T15:36:31.213Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# 任务文档：命名空间优化与样式分离\n\n## 任务列表\n\n- [ ] 1. 实现 `useNamespace` Hook\n    - 创建 `src/hooks/use-namespace/index.ts`。\n    - 实现 `b`, `e`, `m`, `be`, `em`, `bm`, `bem`, `is` 等 BEM 辅助函数。\n    - 确保可以通过全局配置获取 namespace（默认为 'ql'）。\n    - 导出该 Hook 并在 `src/hooks/index.ts` 中暴露。\n    - _Prompt: \"Implement the task for spec optimize-namespace, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Frontend Developer | Task: Create the `useNamespace` hook in `src/hooks/use-namespace/index.ts` to generate BEM class names dynamically. Ensure it supports a default namespace 'ql' and can be configured globally. Export it in `src/hooks/index.ts`. | Restrictions: Follow the design in `design.md`. Do not break existing hooks. | Success: Hook is exported and correctly generates class names based on configuration.\"_\n\n- [ ] 2. 建立 SCSS 基础架构\n    - 创建 `src/styles` 目录。\n    - 创建 `src/styles/mixins/mixins.scss`, `src/styles/mixins/var.scss`, `src/styles/mixins/config.scss`。\n    - 定义 `b`, `e`, `m` 等 SCSS Mixin，确保它们使用可配置的 `$namespace` 变量。\n    - 创建 `src/styles/variables.scss` 用于定义 CSS 变量。\n    - 创建 `src/styles/index.scss` 作为总入口。\n    - _Prompt: \"Implement the task for spec optimize-namespace, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Frontend Developer | Task: Set up the SCSS architecture in `src/styles`. Create mixins for BEM (b, e, m, etc.) in `src/styles/mixins/` that use a configurable `$namespace` variable. Define global variables in `src/styles/variables.scss` and create a main entry in `src/styles/index.scss`. | Restrictions: Use SCSS modules and mixins properly. Ensure compatibility with Element Plus variable names where appropriate. | Success: Global SCSS files are created and can be compiled without errors.\"_\n\n- [ ] 3. 迁移组件样式 (Button & Input 示例)\n    - 选择 1-2 个基础组件（如 Button），将其样式从 `.vue` 文件移除。\n    - 在 `src/components/button/style/index.scss` 中重写样式，使用新创建的 Mixin 和变量。\n    - 更新 `src/components/button/index.vue`，使用 `useNamespace` 替换硬编码的类名。\n    - (注：此任务作为验证，后续需应用到所有组件，这里先做一个 Task 代表性实施)。\n    - _Prompt: \"Implement the task for spec optimize-namespace, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Frontend Developer | Task: Migrate the Button component style. Extract CSS from `src/components/button/index.vue` to `src/components/button/style/index.scss` using the new BEM mixins. Update the vue component to use `useNamespace` hook for dynamic class names. | Restrictions: Maintain existing visual style. Ensure props continue to work. | Success: Button component works with dynamic class names and imported SCSS styles.\"_\n\n- [ ] 4. 增强 `QinLanternResolver`\n    - 修改 `src/resolver/index.ts`。\n    - 增加 `namespace` 和 `importStyle` 选项的支持。\n    - 实现 `resolve` 方法，使其能根据配置返回正确的 `sideEffects` 路径（指向 SCSS 或 CSS）。\n    - _Prompt: \"Implement the task for spec optimize-namespace, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Tooling Engineer | Task: Update `QinLanternResolver` in `src/resolver/index.ts`. Add support for `namespace` and `importStyle` ('css' | 'sass' | boolean) options. Ensure `sideEffects` points to the correct style file path based on the configuration. | Restrictions: Maintain backward compatibility if possible. | Success: Resolver correctly handles new options and resolves paths.\"_\n\n- [ ] 5. 配置构建流程\n    - 修改 `vite.config.ts`。\n    - 配置插件或 Rollup 选项，确保 `src/styles` 和组件的 `style` 目录被复制到 `dist` 中。\n    - 验证 `dist` 目录结构是否符合 Resolver 的预期。\n    - _Prompt: \"Implement the task for spec optimize-namespace, first run spec-workflow-guide to get the workflow guide then implement the task: Role: DevOps Engineer | Task: Update `vite.config.ts` to include SCSS files in the build output. Ensure `src/styles` and component `style` directories are copied to `dist` while maintaining the structure needed for the Resolver. | Restrictions: Do not break existing build outputs (ESM/UMD). | Success: `dist` directory contains required SCSS files after build.\"_\n",
  "fileStats": {
    "size": 4577,
    "lines": 38,
    "lastModified": "2026-01-10T15:36:22.208Z"
  },
  "comments": []
}