# 需求文档：命名空间优化与样式分离

## 1. 概要
本功能旨在通过实现动态命名空间系统并将组件样式分离为独立的 SCSS 文件来优化组件库。这将解决与其他基于 Element Plus 的项目共存时潜在的样式冲突问题，并实现更细粒度的样式定制。

## 2. 问题陈述
- **硬编码命名空间**: 组件目前使用硬编码的类名（可能是 'el-' 或类似前缀），这可能会与宿主应用或其他库发生冲突。
- **样式耦合**: 样式嵌入在 `.vue` 文件中，使得难以覆盖或仅导入必要的样式以进行 Tree-shaking。
- **缺失构建产物**: 构建过程未生成独立的 SCSS 文件，限制了使用者使用库的 SCSS 变量和 Mixin 的能力。
- **Resolver 功能受限**: 当前的 `QinLanternResolver` 缺乏标准 Element Plus Resolver 中具备的命名空间和样式导入类型配置选项。

## 3. 用户故事
### 3.1 命名空间定制
- **作为开发者**，我希望配置自定义命名空间（例如 `ql-`），以便组件样式不会与 Element Plus 或其他库冲突。
- **作为开发者**，我希望 `QinLanternResolver` 在自动导入组件时能够遵循我的自定义命名空间配置。

### 3.2 样式管理
- **作为开发者**，我希望组件样式位于专用的 SCSS 文件中，以便我能轻松找到并管理它们。
- **作为开发者**，我希望能够仅导入特定组件所需的样式，以最小化包体积。
- **作为主题创建者**，我希望能够访问库的 SCSS 变量，以便定制外观以匹配我的品牌。

### 3.3 构建与集成
- **作为开发者**，我希望构建后的 `dist` 目录包含源 SCSS 文件，以便在我的 SCSS 构建流程中使用它们。
- **作为开发者**，我希望在 Resolver 中使用 `importStyle: 'sass'` 来加载源 SCSS 文件而不是预编译的 CSS。

## 4. 功能需求
1.  **动态命名空间支持**:
    - 所有组件必须使用 Hook（如 `useNamespace`）基于全局配置动态生成类名。
    - 模板和脚本中的硬编码类前缀必须替换为动态变量。
2.  **样式分离**:
    - 将 `.vue` 文件中的所有 `<style>` 块提取到 `src/components/[name]/style/index.scss`。
    - 创建全局 `src/styles` 目录用于存放共享变量、Mixin 和重置样式。
3.  **SCSS 架构**:
    - 实现变量系统（BEM），该系统应集成或扩展 Element Plus 的变量。
    - 确保所有组件 SCSS 文件导入必要的依赖（变量、Mixin）。
4.  **Resolver 增强**:
    - 更新 `QinLanternResolver` 以接受 `namespace` 和 `importStyle` 选项。
    - 确保其能正确解析到新的 SCSS 文件路径。
5.  **构建配置**:
    - 配置 Vite 将 SCSS 文件复制到输出目录，同时保留结构或根据导入需求进行扁平化处理。

## 5. 非功能需求
- **向后兼容性**: 如果可能，默认命名空间应保持与现有用法兼容（或明确记录为破坏性变更）。
- **性能**: 样式分离不应负面影响加载时间；应改进 Tree-shaking。
- **可维护性**: 新的目录结构必须在所有组件中保持一致。

## 6. 风险与缓解
- **风险**: 重构所有组件以使用 `useNamespace` 容易出错，可能会遗漏某些硬编码的类名。
    - **缓解**: 全面测试，并可能使用正则/AST 脚本查找硬编码字符串。
- **风险**: SCSS 变量依赖地狱。
    - **缓解**: 建立清晰的导入层级（全局 -> 组件）。

## 7. 成功指标
- 用户可以成功配置 `namespace: 'custom'` 并看到类名更新（例如 `.custom-button`）。
- `dist` 文件夹包含有效的 SCSS 文件。
- `QinLanternResolver` 能够配合 `importStyle: 'sass'` 正常工作。
